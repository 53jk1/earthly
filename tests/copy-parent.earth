VERSION 0.6

WORKDIR /test

all:
    BUILD +copy-single-parent
    BUILD +copy-multi-parent
    BUILD +copy-multiple-contexts


copy-single-parent:
    COPY ../opt/test1 test1/
    RUN find test1 | sort | tee ./actual
    RUN echo "test1
test1/file1
test1/file2
test1/root" >./expected
    RUN diff -b ./actual ./expected

copy-multi-parent:
    COPY ../opt/test1 test1/
    RUN find test1 | sort | tee ./actual
    RUN echo "test1
test1/file1
test1/file2
test1/root" >./expected
    RUN diff -b ./actual ./expected

# should error, COPY can only operate against a single build context
# this test case uses "." and "../"
copy-multiple-contexts:
    COPY ../opt/test1 ./in test1/
    RUN find test1 | sort | tee ./actual
    RUN echo "test1
test1/file1
test1/file2
test1/root" >./expected
    RUN diff -b ./actual ./expected

